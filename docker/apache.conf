<VirtualHost *:80>
    ServerName localhost

    DocumentRoot /var/www/front
    
    # Active le module rewrite
    <Directory /var/www/front>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Redirection des requêtes backend
        RewriteEngine On
        
        # Rediriger /back/public/index.php/contact/send vers le backend
        RewriteCond %{REQUEST_URI} ^/back/public/index.php/contact/send$
        RewriteRule ^back/public/index.php/(.*)$ /var/www/back/public/index.php [L]
    </Directory>
    
    # Alias pour accéder aux fichiers back
    Alias /back/public /var/www/back/public
    <Directory /var/www/back/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Support du routing PHP
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^index.php/(.*)$ index.php [QSA,L]
    </Directory>

    # Configuration PHP
    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>
    
    # Logs (optionnel mais utile pour debug)
    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log combined
</VirtualHost>